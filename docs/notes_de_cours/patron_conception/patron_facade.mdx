---
sidebar_position: 8
sidebar_label: Patron fa√ßade
description: Patron fa√ßade
---

# üè† Patron fa√ßade

Le patron fa√ßade fournit une **interface unifi√©e et simplifi√©e** vers un
ensemble d‚Äôinterfaces appartenant √† un sous‚Äësyst√®me. Il masque la complexit√© interne et
r√©duit le couplage entre le client et les composants internes. Le client
utilise la fa√ßade pour r√©aliser des t√¢ches courantes sans conna√Ætre les d√©tails
du fonctionnement des sous‚Äësyst√®mes.

Id√©e cl√© : la fa√ßade n‚Äôinterdit pas l‚Äôacc√®s direct aux sous‚Äësyst√®mes ‚Äî elle
propose un raccourci ¬´ pr√™t √† l‚Äôemploi ¬ª pour les sc√©narios fr√©quents.

---

## Quand l‚Äôutiliser ?

- Lorsque l‚ÄôAPI d‚Äôun sous‚Äësyst√®me est complexe ou verbeuse et qu‚Äôon veut
  exposer une **API simple et coh√©rente** aux clients.
- Pour **r√©duire le couplage** entre le code client et de multiples classes
  internes (isoler l‚Äôimpact des changements).
- Pour **guider l‚Äôusage**: offrir des parcours ¬´ happy path ¬ª s√ªrs et test√©s.
- Comme **point d‚Äôentr√©e unique** tout en conservant la flexibilit√©
  d‚Äôutiliser les composants bas niveau au besoin.
- En compl√©ment d‚Äôun syst√®me h√©rit√© (legacy) pour **moderniser l‚Äôinterface**
  sans refactoriser tout le code interne.

---

## Diagramme de classes

```mermaid
classDiagram
    class Client
    class Facade {
        +operationSimple()
        +operationComposee()
    }
    class SousSystemeA {
        +a1()
        +a2()
    }
    class SousSystemeB {
        +b1()
        +b2()
    }
    class SousSystemeC {
        +c1()
    }

    Client --> Facade
    Facade --> SousSystemeA
    Facade --> SousSystemeB
    Facade --> SousSystemeC
```

### Explication du diagramme

- `SousSystemeA/B/C` : classes internes r√©alisant le vrai travail, avec leurs
  propres API.
- `Facade` : regroupe des op√©rations de plus haut niveau (`operationSimple`,
  `operationComposee`) en orchestrant plusieurs appels aux sous‚Äësyst√®mes.
- `Client` : d√©pend uniquement de la fa√ßade pour les cas d‚Äôusage communs,
  diminuant ainsi sa d√©pendance envers les d√©tails internes.

---

## Exemple en Python

### Fa√ßade ¬´ home cin√©ma ¬ª (orchestration de sous‚Äësyst√®mes)

```python
class Amplificateur:
	def allumer(self):
		print("Amplificateur ON")
	def regler_volume(self, niveau: int):
		print(f"Volume -> {niveau}")
	def eteindre(self):
		print("Amplificateur OFF")

class LecteurVideo:
	def allumer(self):
		print("Lecteur vid√©o ON")
	def lire(self, titre: str):
		print(f"Lecture du film: {titre}")
	def arreter(self):
		print("Arr√™t lecture")
	def eteindre(self):
		print("Lecteur vid√©o OFF")

class Eclairage:
	def tamiser(self, niveau: int):
		print(f"√âclairage -> {niveau}%")
	def allumer(self):
		print("√âclairage ON")

class HomeCinemaFacade:
	def __init__(self, amp: Amplificateur, video: LecteurVideo, light: Eclairage):
		self.amp = amp
		self.video = video
		self.light = light

	def lancer_film(self, titre: str):
		print("[Fa√ßade] Pr√©parer la s√©ance")
		self.light.tamiser(30)
		self.amp.allumer()
		self.amp.regler_volume(20)
		self.video.allumer()
		self.video.lire(titre)

	def arreter_film(self):
		print("[Fa√ßade] Terminer la s√©ance")
		self.video.arreter()
		self.video.eteindre()
		self.amp.eteindre()
		self.light.allumer()

# Client
amp = Amplificateur()
video = LecteurVideo()
light = Eclairage()
cinema = HomeCinemaFacade(amp, video, light)

cinema.lancer_film("Inception")
cinema.arreter_film()
```

Le client n‚Äôa pas besoin de conna√Ætre la s√©quence exacte d‚Äôappels ni l‚Äôordre.
La fa√ßade orchestre les sous‚Äësyst√®mes.

### Fa√ßade ¬´ commande en ligne ¬ª (processus m√©tier)

```python
class AuthService:
	def verifier(self, user_id: str) -> bool:
		print(f"Auth: v√©rifier {user_id}")
		return True

class StockService:
	def reserver(self, items: list[tuple[str, int]]) -> bool:
		print(f"Stock: r√©server {items}")
		return True

class PaiementService:
	def payer(self, user_id: str, montant: float) -> bool:
		print(f"Paiement: {user_id} -> {montant:.2f} $")
		return True

class EmailService:
	def envoyer_confirmation(self, user_id: str, commande_id: str):
		print(f"Email: confirmation envoy√©e √† {user_id} pour {commande_id}")

class BoutiqueFacade:
	def __init__(self, auth: AuthService, stock: StockService, pay: PaiementService, mail: EmailService):
		self.auth = auth
		self.stock = stock
		self.pay = pay
		self.mail = mail

	def passer_commande(self, user_id: str, panier: list[tuple[str, int]]) -> str:
		if not self.auth.verifier(user_id):
			raise PermissionError("Utilisateur non authentifi√©")
		if not self.stock.reserver(panier):
			raise RuntimeError("Rupture de stock")
		montant = sum(qte * 10.0 for _, qte in panier)  # exemple
		if not self.pay.payer(user_id, montant):
			raise RuntimeError("√âchec du paiement")
		commande_id = "CMD-12345"
		self.mail.envoyer_confirmation(user_id, commande_id)
		return commande_id

# Client
facade = BoutiqueFacade(AuthService(), StockService(), PaiementService(), EmailService())
commande = facade.passer_commande("u42", [("sku-1", 2), ("sku-2", 1)])
print("Commande cr√©√©e:", commande)
```

La fa√ßade expose une m√©thode commande sans exposer chaque service au client.

---

## Comparaison rapide avec Adaptateur

Fa√ßade simplifie/agr√®ge une API existante. Adaptateur convertit une **interface incompatible** vers une autre attendue par le client.

---

## Avantages et inconv√©nients

**Avantages**
- R√©duit la complexit√© per√ßue et le couplage du client.
- Point d‚Äôentr√©e unique facilitant l‚Äô**√©volution** et la **stabilisation de l‚ÄôAPI**.
- Favorise la **lisibilit√©** des cas d‚Äôusage et l‚Äô**isolation** des d√©pendances.

**Inconv√©nients**
- Risque de devenir un **dieu‚Äëobjet** si la fa√ßade grossit trop.
- Peut masquer des erreurs de design sous‚Äëjacentes.
- Ajoute une couche suppl√©mentaire.

---

## R√©f√©rences

- https://refactoring.guru/design-patterns/facade
- https://en.wikipedia.org/wiki/Facade_pattern
- https://www.geeksforgeeks.org/system-design/facade-design-pattern-introduction/

